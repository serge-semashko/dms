receive_89_stepen.cfg

[parameters]
request_name=S:Прием масива УченыеСтепени
LOG=ON
[end]


[report]
$SET_PARAMETERS table=gway.УченыеСтепени;

$GET_DATA receive.cfg[delete existing records]  

$LOG2 <br><b>УченыеСтепени.items=#УченыеСтепени.items#;</b><br>

$EXECUTE_LOOP item; #УченыеСтепени.items#; [receive stepen];    ??!ERROR

[end]


[receive stepen]
$LOG2 <br><b>УченыеСтепени.item=#item#;</b>
$SET_PARAMETERS p1=УченыеСтепени.#item#.УченаяСтепеньКод; p2=УченыеСтепени.#item#.УченаяСтепеньНаименование; p3=УченыеСтепени.#item#.УченаяСтепеньДата; 
$SET_PARAMETERS УченаяСтепеньКод=^#p1#; УченаяСтепеньНаименование=^#p2#; УченаяСтепеньДата=^#p3#;

$SET_PARAMETERS p1=УченыеСтепени.#item#.ОтрасльНауки; p2=УченыеСтепени.#item#.ДипломСерияНомер;  p3=УченыеСтепени.#item#.ДипломКемВыдан; 
$SET_PARAMETERS ОтрасльНауки=^#p1#; ДипломСерияНомер=^#p2#; ДипломКемВыдан=^#p3#;





$LOG <br><b>ERROR=#ERROR#;</b><br>  ??ERROR
$GET_DATA [insert record]  ??!ERROR
[end]


============================================================================
============================================================================
============================================================================


[insert record]
insert into #table# (Код, УченаяСтепеньКод, УченаяСтепеньНаименование, УченаяСтепеньДата, ОтрасльНауки
, ДипломСерияНомер, ДипломКемВыдан, id, DATE_UPD)
              values('#Код#', '#УченаяСтепеньКод#', '#УченаяСтепеньНаименование#'
,  CONVERT(DATETIME,'#УченаяСтепеньДата#',104)  ??УченаяСтепеньДата
, null ??!УченаяСтепеньДата
, '#ОтрасльНауки#', '#ДипломСерияНомер#', '#ДипломКемВыдан#', '#SrcObjectID#', GETDATE())

[end]
 
