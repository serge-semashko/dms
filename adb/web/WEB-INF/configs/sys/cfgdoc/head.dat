sys/cfgdoc/head.dat

[parameters]
[end]


[head]
<HTML><HEAD><TITLE>#title#</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<link rel="stylesheet" href="#jsPath#jquery-ui-1.10.1.css" /> ??
<link rel="stylesheet" href="#jsPath#default/style.min.css" /> ??
<script type="text/javascript" src="#jsPath#jquery-1.9.1.min.js"></script> 
<script src="#jsPath#jquery-ui-1.10.1.min.js" type="text/javascript"></script>  
jquery-ui-1.10.1.min.js ??
<script type="text/javascript" src="#jsPath#jquery-migrate-1.1.1.min.js">??
</script> 


<SCRIPT language=JavaScript src="#jsPath#lib.js"></SCRIPT>
<link rel="stylesheet" href="/sed/css/sed.css" />  ??

$INCLUDE sys/cfgdoc/head.dat[css] 
$INCLUDE sys/cfgdoc/head.dat[js] 
[end]


[css]
<style type="text/css">
body { color:##000; background-color: ##F0F0F0; padding:10px;
   font-family: Verdana,Arial,Helvetica,sans-serif;
    font-size: 9pt;
}

table.tlist {border:solid 1px 0080a0;}
table.tlist .title a, .title a {background-color: ##1f697d; color:##e0f4ff; font-weight:normal; font-size:14pt; }
table.tlist td {font-size: 9pt; border-bottom:solid 1px gray; }
table.tlist .hasnocomments{ color:##f00000;}
table.tblue tr.oddRow {background-color: #e0f4ff;}
table.tblue tr.active {background-color: ##FFFFa0;}
table.tblue tr.sel {background-color: ##FFF8b0;}
tr {background-color: white ; color:##000406;}

.title {float:left; padding:0 10px 0 10px; margin-top:10px; border:solid 1px ##0080a0; border-radius:4px; color:##e0f4ff; font-size:14pt; background-color: ##1f697d;}
.desBlock {background-color:white; padding:10px; float:left; width:98%; margin-right:20px; border:solid 1px gray;}

.hasnocomments{ color:##f00000;}

td { font-size: 9pt; vertical-align: top;}
td.dat {background-color:white;}

##moduleSrc {border:ridge 3px gray; height:500px; overflow:auto;
    font-family: monospace; white-space: nowrap; padding:10px; background-color: white;} 
##formData {padding:0 0 10px 0;}
##popupCont {padding:1px 3px 15px 3px; background-color:##c0c0c0;}

ol li {margin:0 0 7px 0;}
ul li {margin:3px 0 0 -5px;}
.pt { cursor: pointer;}

textarea { font-size: 9pt;}

============================== POP-UP DIALOG =====================?? 
.dialog_overlay {position: absolute; top: 0; right: 0; bottom: 0; left: 0;
		height: 100%; width: 100%;
		margin: 0; padding: 0; background: ##000000;
		opacity: .4; filter: alpha(opacity=40);
    -moz-opacity: .4; z-index: 100;
		display: none;
}

.dialog {display: none; position: absolute; 
width: 60%; height_: 200px; ??
top: 30%; left: 20%; padding: 1px;
background-color: ##ffffff; ??
background-color:whitesmoke;
border: 1px solid #336699; 
border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;
z-index: 110; font-size: 10pt;
}

.dialog_title { border-bottom: solid 2px ##336699; 
background: ##336699 url(/sed/images/head_bg.png) repeat-y right top ; 
padding: 0 0 0 8px; color: white; font-weight:bold;
cursor:default;
}
##popupCont {padding:20px;} ??

</style>
[end]


[js]
<script>
/*
 * AJAX-загрузка контента в target_div.
 * query - запрос в URL-формате (param1=val1¶m2=val2)
 * Запрос выполняется если force=TRUE. 
 * Если force не задано или не boolean, то запрос выполняется, если элемент target_div не скрыт.
 */
var AjaxCall=function(target_div, query, force, containerId) {

  var data = [];
  var vis = false;
  if(typeof (force) == "boolean") vis = force;
  if(!vis) vis = $(`##` + target_div).css(`display`) != `none`;
  if ( vis ) {
    console.log("AjaxCall: " + $(`##` + target_div).css(`display`)); ??
    console.log("AjaxCall: " + target_div + " / " + query); ??

    if(target_div !== "d_tooltip" ??
      && target_div !== "field_property_panel" ??
      && target_div !== "doctype_form_panel" ??
      && target_div !== "toolbar_panel" ??
    ) ??
    showLoading(target_div);  ??вывод индикатора "загрузка" - часто мешается

    if(containerId) data = $("##"+containerId+" input, ##" +containerId+" textarea, ##"+containerId + " select" ).serializeArray();
    var params = query.split("&");
    for(i=0; i<params.length; i++){
        var p = params[i].split("=");
        data.push({name:p[0], value:p[1]});
    }
    data.push({name:"ajax", value:"Y"});
    console.log("AjaxCall data:" + data); data2log(data);

    var request = $.ajax({ url: "#ServletPath#", type: "POST", data:data, dataType: "html" });
        request.done(function( msg ) { if(target_div) $( "##" + target_div ).html( msg ); setStandardEvents(); });
        request.fail(function( jqXHR, textStatus ) { alert( "Ошибка: " + textStatus ); });
  }
  return vis;
}


/*=============================== Popup-диалоги ============================*/ ??
/*=========================================================================*/ ??
var dialogMinWidth=``;

ShowDialog = function(modal, minWidth)
{ 
	oldCmd = "."; // сбрасываем запомненную предыдущую команду 
	$(`##overlay`).height($(document).height()).fadeIn(300); ??
	$(`##overlay`).height($(document).height()).show();
	$("##popupCont").show(); ??
	$("##dialog").fadeIn(300); ??
	$("##dialog").show();

	if(minWidth) {
		console.log($("##dialog").width()); ??
		dialogMinWidth = minWidth;
		if($("##dialog").width() < minWidth)
			$("##dialog").width(minWidth);
	}
	else
		dialogMinWidth = ``;
	
	if (modal)
			$("##overlay").unbind("click");
	else
			$("##overlay").click(function (e) {HideDialog(); });
	$( "##dialog" ).draggable({
	containment:`parent`, ??
	handle: `.dialog_title`});	
	$( "##dialog" ).resizable();  ??
$( "##popupCont" ).resizable(); ??
	dialogOn = true;
	centerDialog();
}

var HideDialog=function()
{
	$("##overlay").hide();
	$("##dialog").fadeOut(300);
	$("##popupCont").html("");
	dialogOn = false;
} 

centerDialog = function(){
	if (!dialogOn) return;

	var h = document.body.offsetHeight-200;
	if(document.all) h = h - 40; ??
	if (h<200) h=200;
	if (h>500) h=500;
	$(`##ptree`).height(h); ??
	
$("##popupCont").width(9*$("body").innerWidth() / 10);

	if(dialogMinWidth)
		if($("##dialog").width() < dialogMinWidth)
			$("##dialog").width(dialogMinWidth);
			
//  if(document.all) t = ($("body").innerHeight() - $(`.dialog`).outerHeight())/2 + $(window).scrollTop(); ??
//	else t = ($("window").innerHeight() - $(`.dialog`).outerHeight())/2 + $(window).scrollTop(); ??
//	t=$(window).scrollTop() + 10;
	var top = window.document.body.scrollTop + 50 + (h - $(`.dialog`).outerHeight())/2 ;
	if (top<10) top=10;
        var left = ($("body").innerWidth() - $(`.dialog`).outerWidth())/2;
console.log("centerDialog: body.innerWidth=" + $("body").innerWidth() + "; dialog.outerWidth=" + $(`.dialog`).outerWidth() + ";"); 
console.log("centerDialog: top=" + top + "; left=" + left + ";"); 
	$(`.dialog`).css({
		position:`absolute`,
		left: left,
		left: ($("body").innerWidth() - $(`.dialog`).outerWidth())/2, 
		top: top
	});
}

$(window).resize(function(){
centerDialog();
	});

var showMsg = function(selector, msg)
{
	var m= (msg)? msg: "<center><h3><br><br><br>Загрузка...<br><br><br><br></h3>"; ??
	var m= (msg)? msg: $("##loadingMsg").html();
	$(selector).each(function() {$(this).html(m); });
	{$(this)[0].innerHTML=m; }); ??
}

/*------------------ Установка обработчиков -------------------- */ ??
var setStandardEvents = function()
{	$(`.srh, .filter, .spr_item, .pt, .info_input, .fe`).unbind();
	$(`.srh, td.filter, td.spr_item, .pt, .info_input`).mouseout(sel);
	$(`.srh, td.filter, td.spr_item, .pt, .info_input`).mouseover(sel); 

	$(".resize").resizable(); 
console.log("...setStandardEvents..."); 
}

var data2log = function(d) {
    for(i=0; i<d.length; i++) {
        console.log(i + ": " + d[i].name + "=" + d[i].value);
    }
}

var sel = function(ev) {
$("##firstRow").removeClass("sel");
	if(ev.type == "mouseover") $(this).addClass("sel");
	else if(ev.type == "mouseout")	$(this).removeClass("sel");
	return true;
}

</script>

[end]

[aaa]
Test 'aa' "bb" `cc`
asdasdas
[end]
