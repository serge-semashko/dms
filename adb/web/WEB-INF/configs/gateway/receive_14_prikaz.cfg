gateway/receive_14_prikaz.cfg


[parameters]
request_name=S:Прием статьи
LOG=ON
[end]


[report]
$LOG1 <hr><b>===>>> receive_14_prikaz.cfg</b><br>
$LOG5 object=#Object#;<br> 
$SET_PARAMETERS ERR_CODE=0; ERROR=; Элемент_Ref=#SrcObjectID#;
$SET_PARAMETERS ERROR=#ERROR# Отсутствует Элемент Ref;  ??!Элемент_Ref
$SET_PARAMETERS ERROR=#ERROR# Отсутствует Наименование; ??!Наименование
$SET_PARAMETERS ERROR=#ERROR# Отсутствует Код;          ??!Код
$SET_PARAMETERS ERROR=#ERROR# Отсутствует НомерПриказа; ??!НомерПриказа&!ЭтоГруппа=1
$SET_PARAMETERS ERROR=#ERROR# Отсутствует ДатаПриказа;  ??!ДатаПриказа



$GET_DATA [check existing record] ??!ERROR
$GET_DATA [create record] ??!DOC_EXISTS&!ERROR
$GET_DATA [update record] ??!ERROR

$SET_PARAMETERS DOC_ID=#Элемент_Ref#
$SET_PARAMETERS ResultCode=3; ERR_CODE=3; Result=#ERROR#; ??ERROR
[end]



"ДатаПриказа": "25.04.2016 00:00:00",
"Валюта": "f95eef37-d7bd-11e1-bad5-e0cb4eda5b1f",
"ВалютаКод": "978",
"Свойство": "dd963828-0ae3-11e6-945c-0025907d24fa",
"СвойствоКод": "511850",
"ДатаОкончания": "31.12.2017 00:00:00" 
}

  DAT DATE,
  PID NUMBER(*, 0),
  NAME NVARCHAR2(255) NOT NULL,
  TYPE NVARCHAR2(255),
CURR_CODE NUMBER(*, 0),
  DATE_END DATE,
  IS_DELETED NUMBER(*, 0) DEFAULT 0 NOT NULL,
  DATE_UPD DATE NOT NULL)
TABLESPACE USERS


============================================================================
============================================================================
============================================================================

[check existing record]
select 'Y' as DOC_EXISTS from C3_PRIKAZ
where REF='#Элемент_Ref#'
[end]


[create record]
insert into C3_PRIKAZ (ref, code,  name, DATE_UPD)
values ('#Элемент_Ref#', #Код#, '#Наименование#', SYSDATE)
[end]
 

[update record]
update C3_PRIKAZ 
      set code=#Код#
    , num=#НомерПриказа#    ??НомерПриказа
    , num=null              ??!НомерПриказа
    , pid=#РодительКод#     ??РодительКод
    , pid=null              ??!РодительКод
    , name='#Наименование#'
    , TYPE='#ВидПриказа#'
    , dat=to_date('#ДатаПриказа#', 'DD.MM.YYYY HH24:MI:SS')  ??ДатаПриказа
    , DATE_END=to_date('#ДатаОкончания#', 'DD.MM.YYYY HH24:MI:SS')  ??ДатаОкончания
    , is_group=0    ??!ЭтоГруппа=1
    , is_group=1    ??ЭтоГруппа=1
    , is_deleted=0  ??ПометкаУдаления=Нет
    , is_deleted=1  ??!ПометкаУдаления=Нет
    , DATE_UPD=SYSDATE
where ref='#Элемент_Ref#'
[end]

