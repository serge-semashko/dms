[parameters]
service=dubna.walt.service.Service
KeepLog=true
[end]


[report]
<br>ViewDB user has been created on <b>#db~s#</b><br> ??!CALL_SERVICE_ERROR
[end]


[preSQLs]
$INCLUDE [Create User]
$INCLUDE [sqlplan]
[end]

[Create User]
try: select DEFAULT_TABLESPACE as DEF_TS from dba_users where username='SYSTEM';
$SET_PARAMETERS DEF_TS=TOOLS ??!DEF_TS

CREATE USER "#usr#" PROFILE "DEFAULT" IDENTIFIED BY "#pwd#"
DEFAULT TABLESPACE "#DEF_TS#"
QUOTA UNLIMITED ON #DEF_TS#
;

try: GRANT "CONNECT" TO "#usr#";
GRANT SELECT ANY TABLE TO "#usr#";
GRANT EXECUTE ANY PROCEDURE TO "#usr#";
GRANT EXECUTE ANY LIBRARY TO "#usr#";
GRANT EXECUTE ANY OPERATOR TO "#usr#";
GRANT ALTER SESSION TO "#usr#";
GRANT ALTER SYSTEM TO "#usr#";
GRANT ANALYZE ANY TO "#usr#";
GRANT BECOME USER TO "#usr#";
try: GRANT ALTER ANY SNAPSHOT TO "#usr#";
try: GRANT SELECT ANY DICTIONARY TO "#usr#";
[end]


GRANT SELECT ANY TABLE TO VIEWDB;
GRANT EXECUTE ANY PROCEDURE TO VIEWDB;
GRANT EXECUTE ANY LIBRARY TO VIEWDB;
GRANT EXECUTE ANY OPERATOR TO VIEWDB;
GRANT ALTER SESSION TO VIEWDB;
GRANT ALTER SYSTEM TO VIEWDB;
GRANT ANALYZE ANY TO VIEWDB;
GRANT BECOME USER TO VIEWDB;
GRANT ALTER ANY SNAPSHOT TO VIEWDB;
GRANT SELECT ANY DICTIONARY TO VIEWDB;

select * from dba_sys_privs where grantee = 'VIEWDB'

[sqlplan]
ALTER SESSION SET CURRENT_SCHEMA=#usr#;
try: drop table sqlplan;

CREATE TABLE sqlplan (
STATEMENT_ID varchar2(60)
,TIMESTAMP Date
,REMARKS   varchar2(2000)
,OPERATION varchar2(30)
,OPTIONS   varchar2(30)
,OBJECT_NODE  varchar2(128)
,OBJECT_OWNER varchar2(30)
,OBJECT_NAME  varchar2(30)
,OBJECT_INSTANCE number
,OBJECT_TYPE  varchar2(30)
,SEARCH_COLUMNS number
,ID number
,PARENT_ID number
,POSITION number
,OTHER long
,COLLECTOR varchar2(31)
,ADDRESS varchar2(16)
,HASH_VALUE number
,OPTIMIZER varchar2(255)
,COST number
,CARDINALITY number
,BYTES number
,OTHER_TAG varchar2(255)
,PARTITION_START varchar2(255)
,PARTITION_STOP varchar2(255)
,PARTITION_ID number(38)
,JOIN_TEXT varchar2(1000)
,FILTER_TEXT varchar2(1000)
,VIEW_TEXT varchar2(1000));
[end]

